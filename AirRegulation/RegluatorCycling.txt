import serial
import minimalmodbus
ins = serial.Instrument('COM10',247)
arduino = serial.Instrumer('COM2",)

pressure = 0
pvalue = pressure*655
set grms = 0
set stepsize = 3
set steplength = 10mins
n = 1
arduino.read_register(x)
grms = arduino read value
For t < steplength
If
	grms < (stepsize - 1) && grms > (stepsize-3)
	set pvalue = pvalue + 100
	ins.write_register(49,pvalue)
end
If grms > (stepsize+1) && grms < (stepsize+3)
	 set pvalue = pvalue - 100
	ins.write_register(49,pvalue)
end
If grms > (stepsize +3)
	set pvalue = pvalue - 1000
	ins.write_register(49,pvalue)
end
If grms < stepsize-3)
	set pvalue = pvalue +1000
	ins.write_register(49,pvalue)
end
end
n = n+1
reloop

ins.read_register(1)
